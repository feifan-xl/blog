<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.66">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title></title><meta name="description" content="">
    <link rel="preload" href="/blog/assets/style-35f1ccaa.css" as="style"><link rel="stylesheet" href="/blog/assets/style-35f1ccaa.css">
    <link rel="modulepreload" href="/blog/assets/app-5e6e879c.js"><link rel="modulepreload" href="/blog/assets/gc.html-4f5ca7c4.js"><link rel="modulepreload" href="/blog/assets/gc.html-563ee104.js"><link rel="prefetch" href="/blog/assets/index.html-cf3d36dd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-75a7baaa.js" as="script"><link rel="prefetch" href="/blog/assets/wasm.html-e0d1a29b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0e6bd63b.js" as="script"><link rel="prefetch" href="/blog/assets/gpt.html-441893de.js" as="script"><link rel="prefetch" href="/blog/assets/rust.html-fb5c93f8.js" as="script"><link rel="prefetch" href="/blog/assets/sso.html-40b7c1cc.js" as="script"><link rel="prefetch" href="/blog/assets/webrtc.html-eeaf9dbd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-88bff350.js" as="script"><link rel="prefetch" href="/blog/assets/http.html-dd874a37.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-46a50a54.js" as="script"><link rel="prefetch" href="/blog/assets/safe.html-0957ca87.js" as="script"><link rel="prefetch" href="/blog/assets/binary-search.html-9d3b9691.js" as="script"><link rel="prefetch" href="/blog/assets/bit-operation.html-574d1397.js" as="script"><link rel="prefetch" href="/blog/assets/catalog.html-23ae0bb4.js" as="script"><link rel="prefetch" href="/blog/assets/dp.html-5f27dbc6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-138f5dc6.js" as="script"><link rel="prefetch" href="/blog/assets/other.html-8e893845.js" as="script"><link rel="prefetch" href="/blog/assets/滑动窗口.html-e204f645.js" as="script"><link rel="prefetch" href="/blog/assets/贪心和回溯.html-2a9e5344.js" as="script"><link rel="prefetch" href="/blog/assets/data-structure.html-343a75ad.js" as="script"><link rel="prefetch" href="/blog/assets/cache.html-20ad873e.js" as="script"><link rel="prefetch" href="/blog/assets/cross.html-ab1cf48c.js" as="script"><link rel="prefetch" href="/blog/assets/event-model.html-defc7bc9.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d81f7618.js" as="script"><link rel="prefetch" href="/blog/assets/render.html-136cc72d.js" as="script"><link rel="prefetch" href="/blog/assets/router.html-dfa5452b.js" as="script"><link rel="prefetch" href="/blog/assets/topic-1-渲染流程.html-f94aa2d6.js" as="script"><link rel="prefetch" href="/blog/assets/topic-2-性能优化.html-ef097247.js" as="script"><link rel="prefetch" href="/blog/assets/bfc.html-9a576c35.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5412ce67.js" as="script"><link rel="prefetch" href="/blog/assets/prefix.html-5650758b.js" as="script"><link rel="prefetch" href="/blog/assets/responsive.html-1f054495.js" as="script"><link rel="prefetch" href="/blog/assets/babel.html-7dc82796.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0f6e2682.js" as="script"><link rel="prefetch" href="/blog/assets/other.html-b03be679.js" as="script"><link rel="prefetch" href="/blog/assets/vite_rollup.html-2e8368a9.js" as="script"><link rel="prefetch" href="/blog/assets/webpack.html-bbe76151.js" as="script"><link rel="prefetch" href="/blog/assets/arrayBuffer.html-a7c42b8b.js" as="script"><link rel="prefetch" href="/blog/assets/async.html-60dcec3d.js" as="script"><link rel="prefetch" href="/blog/assets/class.html-8cc55fc9.js" as="script"><link rel="prefetch" href="/blog/assets/function.html-7834c5f1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-cee5492d.js" as="script"><link rel="prefetch" href="/blog/assets/iterator_generator.html-84be86fe.js" as="script"><link rel="prefetch" href="/blog/assets/let_const.html-74e24d31.js" as="script"><link rel="prefetch" href="/blog/assets/promise.html-b0522fd8.js" as="script"><link rel="prefetch" href="/blog/assets/set_map.html-c3e3749f.js" as="script"><link rel="prefetch" href="/blog/assets/widget.html-cb9477b9.js" as="script"><link rel="prefetch" href="/blog/assets/algorithm.html-466b7fef.js" as="script"><link rel="prefetch" href="/blog/assets/async-and-event_loop.html-b1397fb3.js" as="script"><link rel="prefetch" href="/blog/assets/data-type.html-0ecbc475.js" as="script"><link rel="prefetch" href="/blog/assets/fp.html-b85b24d3.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e52f4c51.js" as="script"><link rel="prefetch" href="/blog/assets/module.html-1810eae3.js" as="script"><link rel="prefetch" href="/blog/assets/prototype.html-464940f2.js" as="script"><link rel="prefetch" href="/blog/assets/scoped.html-37ff1969.js" as="script"><link rel="prefetch" href="/blog/assets/this.html-20a44493.js" as="script"><link rel="prefetch" href="/blog/assets/widget.html-f485dbb5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-10bfc81e.js" as="script"><link rel="prefetch" href="/blog/assets/micro-fe.html-63a8e384.js" as="script"><link rel="prefetch" href="/blog/assets/小程序.html-40407cf6.js" as="script"><link rel="prefetch" href="/blog/assets/fiber.html-a6899419.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-30415461.js" as="script"><link rel="prefetch" href="/blog/assets/core.html-3e0b49bd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-38b068fb.js" as="script"><link rel="prefetch" href="/blog/assets/between_2_and_3.html-ef613832.js" as="script"><link rel="prefetch" href="/blog/assets/computed_and_watch.html-7349a438.js" as="script"><link rel="prefetch" href="/blog/assets/core.html-66bd6281.js" as="script"><link rel="prefetch" href="/blog/assets/diff.html-2e35534a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-aa1733f1.js" as="script"><link rel="prefetch" href="/blog/assets/pinia _ vuex.html-08a94569.js" as="script"><link rel="prefetch" href="/blog/assets/pub-sub.html-9c42a081.js" as="script"><link rel="prefetch" href="/blog/assets/mediator.html-cafe0e50.js" as="script"><link rel="prefetch" href="/blog/assets/observer.html-0af728e7.js" as="script"><link rel="prefetch" href="/blog/assets/adapter.html-f5ecc03a.js" as="script"><link rel="prefetch" href="/blog/assets/brideg.html-bed2d6ab.js" as="script"><link rel="prefetch" href="/blog/assets/decorator.html-a55e2f06.js" as="script"><link rel="prefetch" href="/blog/assets/proxy.html-a00887c1.js" as="script"><link rel="prefetch" href="/blog/assets/factory.html-bbd1b412.js" as="script"><link rel="prefetch" href="/blog/assets/single.html-e799ea7a.js" as="script"><link rel="prefetch" href="/blog/assets/quick-sort.html-31061918.js" as="script"><link rel="prefetch" href="/blog/assets/sort.html-d865088d.js" as="script"><link rel="prefetch" href="/blog/assets/404.html-60b35caa.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3cf864cd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-adf52756.js" as="script"><link rel="prefetch" href="/blog/assets/wasm.html-b313f073.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3e730603.js" as="script"><link rel="prefetch" href="/blog/assets/gpt.html-d6e37fc7.js" as="script"><link rel="prefetch" href="/blog/assets/rust.html-0cec0fb4.js" as="script"><link rel="prefetch" href="/blog/assets/sso.html-612e1d89.js" as="script"><link rel="prefetch" href="/blog/assets/webrtc.html-ecb57a46.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-88465e0a.js" as="script"><link rel="prefetch" href="/blog/assets/http.html-4604b2a2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-460042da.js" as="script"><link rel="prefetch" href="/blog/assets/safe.html-5ec33b75.js" as="script"><link rel="prefetch" href="/blog/assets/binary-search.html-15da20df.js" as="script"><link rel="prefetch" href="/blog/assets/bit-operation.html-6747bb73.js" as="script"><link rel="prefetch" href="/blog/assets/catalog.html-a20b5187.js" as="script"><link rel="prefetch" href="/blog/assets/dp.html-270e12dd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-435af5d8.js" as="script"><link rel="prefetch" href="/blog/assets/other.html-aeaed0e6.js" as="script"><link rel="prefetch" href="/blog/assets/滑动窗口.html-66cdf5dc.js" as="script"><link rel="prefetch" href="/blog/assets/贪心和回溯.html-b195d988.js" as="script"><link rel="prefetch" href="/blog/assets/data-structure.html-72c36693.js" as="script"><link rel="prefetch" href="/blog/assets/cache.html-48ec8fa5.js" as="script"><link rel="prefetch" href="/blog/assets/cross.html-7484a115.js" as="script"><link rel="prefetch" href="/blog/assets/event-model.html-55be845b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-cfd329c1.js" as="script"><link rel="prefetch" href="/blog/assets/render.html-f28f56a5.js" as="script"><link rel="prefetch" href="/blog/assets/router.html-3c7d7a42.js" as="script"><link rel="prefetch" href="/blog/assets/topic-1-渲染流程.html-b775aec1.js" as="script"><link rel="prefetch" href="/blog/assets/topic-2-性能优化.html-9143eae7.js" as="script"><link rel="prefetch" href="/blog/assets/bfc.html-b07c9eb2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e6e3619a.js" as="script"><link rel="prefetch" href="/blog/assets/prefix.html-640ff714.js" as="script"><link rel="prefetch" href="/blog/assets/responsive.html-21ba4283.js" as="script"><link rel="prefetch" href="/blog/assets/babel.html-7735a7b2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9b6caee7.js" as="script"><link rel="prefetch" href="/blog/assets/other.html-5d94333e.js" as="script"><link rel="prefetch" href="/blog/assets/vite_rollup.html-12e37bdc.js" as="script"><link rel="prefetch" href="/blog/assets/webpack.html-078b5e08.js" as="script"><link rel="prefetch" href="/blog/assets/arrayBuffer.html-13790678.js" as="script"><link rel="prefetch" href="/blog/assets/async.html-172ec57d.js" as="script"><link rel="prefetch" href="/blog/assets/class.html-1d2b4c53.js" as="script"><link rel="prefetch" href="/blog/assets/function.html-59ed56b8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-91ee64e0.js" as="script"><link rel="prefetch" href="/blog/assets/iterator_generator.html-515b7652.js" as="script"><link rel="prefetch" href="/blog/assets/let_const.html-4f0f2360.js" as="script"><link rel="prefetch" href="/blog/assets/promise.html-fd371f8c.js" as="script"><link rel="prefetch" href="/blog/assets/set_map.html-5f2555c7.js" as="script"><link rel="prefetch" href="/blog/assets/widget.html-fd738048.js" as="script"><link rel="prefetch" href="/blog/assets/algorithm.html-b3dba719.js" as="script"><link rel="prefetch" href="/blog/assets/async-and-event_loop.html-409fabab.js" as="script"><link rel="prefetch" href="/blog/assets/data-type.html-219c7376.js" as="script"><link rel="prefetch" href="/blog/assets/fp.html-189a2da9.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-8d2bfa5c.js" as="script"><link rel="prefetch" href="/blog/assets/module.html-7e5fd555.js" as="script"><link rel="prefetch" href="/blog/assets/prototype.html-93977f1c.js" as="script"><link rel="prefetch" href="/blog/assets/scoped.html-6c532f79.js" as="script"><link rel="prefetch" href="/blog/assets/this.html-40ed9b45.js" as="script"><link rel="prefetch" href="/blog/assets/widget.html-83633006.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-a892a658.js" as="script"><link rel="prefetch" href="/blog/assets/micro-fe.html-3c3c75dc.js" as="script"><link rel="prefetch" href="/blog/assets/小程序.html-d9f8648c.js" as="script"><link rel="prefetch" href="/blog/assets/fiber.html-2c746c26.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-bba4250b.js" as="script"><link rel="prefetch" href="/blog/assets/core.html-1d42920a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e699563b.js" as="script"><link rel="prefetch" href="/blog/assets/between_2_and_3.html-6b98fde3.js" as="script"><link rel="prefetch" href="/blog/assets/computed_and_watch.html-aa073587.js" as="script"><link rel="prefetch" href="/blog/assets/core.html-3c40c05c.js" as="script"><link rel="prefetch" href="/blog/assets/diff.html-bad8cc14.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b735e3ce.js" as="script"><link rel="prefetch" href="/blog/assets/pinia _ vuex.html-18be13b5.js" as="script"><link rel="prefetch" href="/blog/assets/pub-sub.html-5c16b751.js" as="script"><link rel="prefetch" href="/blog/assets/mediator.html-f298d990.js" as="script"><link rel="prefetch" href="/blog/assets/observer.html-047b1995.js" as="script"><link rel="prefetch" href="/blog/assets/adapter.html-b0168cd7.js" as="script"><link rel="prefetch" href="/blog/assets/brideg.html-062607c2.js" as="script"><link rel="prefetch" href="/blog/assets/decorator.html-b37d67e1.js" as="script"><link rel="prefetch" href="/blog/assets/proxy.html-a7ad8f50.js" as="script"><link rel="prefetch" href="/blog/assets/factory.html-4f305d0f.js" as="script"><link rel="prefetch" href="/blog/assets/single.html-95466993.js" as="script"><link rel="prefetch" href="/blog/assets/quick-sort.html-bcf9d249.js" as="script"><link rel="prefetch" href="/blog/assets/sort.html-acec4b67.js" as="script"><link rel="prefetch" href="/blog/assets/404.html-302c7c90.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/blog/" class=""><!----><!--v-if--></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/blog/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/front-end/" class="router-link-active" aria-label="front-end"><!--[--><!--]--> front-end <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/CS-other/" class="" aria-label="cs-other"><!--[--><!--]--> cs-other <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/algorithm-and-data" class="" aria-label="algorithm and data structure"><!--[--><!--]--> algorithm and data structure <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/blog/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/front-end/" class="router-link-active" aria-label="front-end"><!--[--><!--]--> front-end <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/CS-other/" class="" aria-label="cs-other"><!--[--><!--]--> cs-other <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/algorithm-and-data" class="" aria-label="algorithm and data structure"><!--[--><!--]--> algorithm and data structure <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading"> <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog/front-end/browser/gc.html#gc" class="router-link-active router-link-exact-active sidebar-item" aria-label="GC"><!--[--><!--]--> GC <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/front-end/browser/gc.html#gc-catalog" class="router-link-active router-link-exact-active sidebar-item" aria-label="GC catalog"><!--[--><!--]--> GC catalog <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/front-end/browser/gc.html#memory" class="router-link-active router-link-exact-active sidebar-item" aria-label="memory"><!--[--><!--]--> memory <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/front-end/browser/gc.html#notica" class="router-link-active router-link-exact-active sidebar-item" aria-label="notica"><!--[--><!--]--> notica <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/front-end/browser/gc.html#sum" class="router-link-active router-link-exact-active sidebar-item" aria-label="sum"><!--[--><!--]--> sum <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h3 id="gc" tabindex="-1"><a class="header-anchor" href="#gc" aria-hidden="true">#</a> GC</h3><p>GC(garbage collection) 垃圾回收，指程序中不再需要使用某个变量，需要对这些对象进行销毁，释放其所占用的内存资源，</p><p>无用变量仍占用内存空间，造成资源浪费</p><h3 id="gc-catalog" tabindex="-1"><a class="header-anchor" href="#gc-catalog" aria-hidden="true">#</a> GC catalog</h3><h4 id="引用计数类型-reference-gc" tabindex="-1"><a class="header-anchor" href="#引用计数类型-reference-gc" aria-hidden="true">#</a> 引用计数类型 reference GC</h4><p>引用计数(reference-counting): 每个对象配置一个 计数器 ， 用于记录指向该对象的引用个数，GC触发时会回收计数为 0 的对象</p><p>IE8 以前版本</p><h4 id="追溯类型-tracing-gc" tabindex="-1"><a class="header-anchor" href="#追溯类型-tracing-gc" aria-hidden="true">#</a> 追溯类型 Tracing GC</h4><p>标记-清除(mark-sweep): 扫描整个 heap，标出可到达对象，然后执行 sweep 操作回收不可到达的对象</p><p>标记-压缩(mark-compact): 扫描整个 heap，标出可到达对象，然后执行 compact(重新安排课达到对象，再更新指向可达对象的指针)操作回收</p><p>复制(copying): 同 stop-copy,把所有可到达对象移动到一个区域，heap 中剩余的空间全部清除</p><p>non-copying implicit(隐性的)</p><h4 id="增量类型-incremental-gc" tabindex="-1"><a class="header-anchor" href="#增量类型-incremental-gc" aria-hidden="true">#</a> 增量类型 incremental GC</h4><p>垃圾回收的线程 分多个小批次执行。这样每次造成的 应用程序的线程 停顿都很小。</p><h4 id="分代类型-generational-gc" tabindex="-1"><a class="header-anchor" href="#分代类型-generational-gc" aria-hidden="true">#</a> 分代类型 generational gc</h4><p>对于大多数应用来说，多数对象在创建不久即会成为垃圾。因此，需要针对不同 age 的对象来划分不同区域，并采用不同的回收策略。一般情况下，可以简单的分为两个代：younger、older。</p><p>younger： 存放活跃的对象，需要经常进行垃圾回收 older： 存放不活跃的独享，回收频率低。</p><p>晋升: 在一定条件下，将处在新生代的对象转移到老生代的过程。</p><h4 id="v8-gc" tabindex="-1"><a class="header-anchor" href="#v8-gc" aria-hidden="true">#</a> v8 gc</h4><p>从全局看，V8 使用了 Generational GC， 而在 new space 中又采用了 Copying GC，在 old space 中采用 incremental marking + lazy sweeping</p><blockquote><p>link： http://newhtml.net/v8-garbage-collection/</p></blockquote><h3 id="memory" tabindex="-1"><a class="header-anchor" href="#memory" aria-hidden="true">#</a> memory</h3><p>有关垃圾回收:</p><ol><li>引用计数垃圾收集， 两个相互引用的对象 就不会被回收</li><li>标记清除算法 由根部出发触及不到的对象被标记为不再使用，进行回收</li></ol><hr><p>js 内存的垃圾回收机制为 标记清除(mark-and-sweep)， 变量进入环境时标记， 离开环境时，标记为离开环境</p><ol><li>意外的全局变量</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>  function foo(arg) {
    a = &#39;1&#39;
  }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>循环引用</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>  function func () {
    let obj1 = {}
    let obj2 = {}

    obj1.a = obj2
    obj2.a = obj1
  }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>被遗忘的计时器和回调</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>  let someResource = getData();  
  setInterval(() =&gt; {  
      const node = document.getElementById(&#39;Node&#39;);  
      if(node) {  
          node.innerHTML = JSON.stringify(someResource));  
      }  
  }, 1000);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>DOM 泄露 a. 没有清理的DOM元素引用<div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>  var refA = document.getElementById(&#39;refA&#39;);
  document.body.removeChild(refA);
  // #refA不能回收，因为存在变量refA对它的引用。将其对#refA引用释放，但还是无法回收#refA。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>b. 给DOM对象添加的属性是一个对象的引用 c. DOM对象与js对象相互引用 d. 从外到内执行appendChild。这时即使调用removeChild也无法释放:</p><ol start="5"><li>closure 闭包会引起内存泄露，但不是必然</li></ol><h3 id="notica" tabindex="-1"><a class="header-anchor" href="#notica" aria-hidden="true">#</a> notica</h3><ol><li>减少不必要去全局变量</li><li>使用完数据后，及时解除引用(闭包中的变量， dom的引用， 定时器清除)</li><li>组织好逻辑，避免死循环等造成的浏览器卡顿 崩溃问题</li></ol><h4 id="识别方法" tabindex="-1"><a class="header-anchor" href="#识别方法" aria-hidden="true">#</a> 识别方法</h4><p>pc: 通过 devlopment tool 中 performance 面板， node: 通过 process.memoryUsage 方法查看内存</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>console.log(process.memoryUsage());
// { 
//     rss: 27709440,
//     heapTotal: 5685248,
//     heapUsed: 3449392,
//     external: 8772 
// }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>rss（resident set size）：所有内存占用，包括指令区和堆栈。</li><li>heapTotal：&quot;堆&quot;占用的内存，包括用到的和没用到的。</li><li>heapUsed：用到的堆的部分。 (判断内存泄露以此为准)</li><li>external： V8 引擎内部的 C++ 对象占用的内存。</li></ul><h2 id="sum" tabindex="-1"><a class="header-anchor" href="#sum" aria-hidden="true">#</a> sum</h2><ul><li>旧版采用 引用计数 ie8前 无法解决循环引用</li><li>标记清除 <ul><li>从根(window)开始, 标记所有可访问到的对象</li><li>对未访问到的对象进行清除</li></ul></li><li>V8 分代回收 <ul><li>新生代 基于可达性分析,找出根引用,遍历所有跟引用,可打到的对象打上标记即为活跃对象 <ul><li>活跃对象，经常进行垃圾回收</li><li>from/to 两个区域, 放入 from, 当 from 被占满时, 新生代GC启动, 算法会检查 from 空间中存活的对象并复制到 to 空间，失活对象就会摧毁,然后from to空间互换 本次gc结束 <ul><li>晋升 <ol><li>新生代中对象已经经历过一次 垃圾会送， 会被晋升到老生代空间</li><li>to空间对象占比大小超过25% 为了不影响到内存分配，会将对象从新生代空间移到老生代空间中</li></ol></li></ul></li></ul></li><li>老生代 <ul><li>不活跃对象，回收频率低 标记压缩 标记清除 <ul><li>触发时机 <ul><li>某一个空间没有分块的时候</li><li>空间中被对象超过一定限制</li><li>空间不能保证新生代中的对象移动到老生代中</li></ul></li></ul><ol><li>标记清除算法, 且会出现内存碎片</li></ol><ul><li>从引用根节点开始遍历 标记所有被引用的对象</li><li>对 堆内存从头到尾进行线性遍历，没有标记就被回收</li></ul><ol start="2"><li>当碎片超国一定限制，会自动压缩算法，在压缩过程中，将活的对象像一端移动，直到所有对象都移动完成然后清理掉不需要的内存</li></ol></li></ul></li></ul></li><li>v8 最新 并行 增量 并发， 减少主线程挂起的时间 <ul><li>并行是主线程和协助线程同时执行同样的工作</li><li>增量式垃圾回收是主线程间歇性的去做少量的垃圾回收的方式</li><li>并发是主线程一直执行 JavaScript，而辅助线程在后台完全的执行垃圾回收</li></ul></li></ul></div><!--[--><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/blog/assets/app-5e6e879c.js" defer></script>
  </body>
</html>
