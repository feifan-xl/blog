<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.66">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title></title><meta name="description" content="">
    <link rel="preload" href="/blog/assets/style-35f1ccaa.css" as="style"><link rel="stylesheet" href="/blog/assets/style-35f1ccaa.css">
    <link rel="modulepreload" href="/blog/assets/app-5e6e879c.js"><link rel="modulepreload" href="/blog/assets/webpack.html-078b5e08.js"><link rel="modulepreload" href="/blog/assets/webpack.html-bbe76151.js"><link rel="prefetch" href="/blog/assets/index.html-cf3d36dd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-75a7baaa.js" as="script"><link rel="prefetch" href="/blog/assets/wasm.html-e0d1a29b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0e6bd63b.js" as="script"><link rel="prefetch" href="/blog/assets/gpt.html-441893de.js" as="script"><link rel="prefetch" href="/blog/assets/rust.html-fb5c93f8.js" as="script"><link rel="prefetch" href="/blog/assets/sso.html-40b7c1cc.js" as="script"><link rel="prefetch" href="/blog/assets/webrtc.html-eeaf9dbd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-88bff350.js" as="script"><link rel="prefetch" href="/blog/assets/http.html-dd874a37.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-46a50a54.js" as="script"><link rel="prefetch" href="/blog/assets/safe.html-0957ca87.js" as="script"><link rel="prefetch" href="/blog/assets/binary-search.html-9d3b9691.js" as="script"><link rel="prefetch" href="/blog/assets/bit-operation.html-574d1397.js" as="script"><link rel="prefetch" href="/blog/assets/catalog.html-23ae0bb4.js" as="script"><link rel="prefetch" href="/blog/assets/dp.html-5f27dbc6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-138f5dc6.js" as="script"><link rel="prefetch" href="/blog/assets/other.html-8e893845.js" as="script"><link rel="prefetch" href="/blog/assets/滑动窗口.html-e204f645.js" as="script"><link rel="prefetch" href="/blog/assets/贪心和回溯.html-2a9e5344.js" as="script"><link rel="prefetch" href="/blog/assets/data-structure.html-343a75ad.js" as="script"><link rel="prefetch" href="/blog/assets/cache.html-20ad873e.js" as="script"><link rel="prefetch" href="/blog/assets/cross.html-ab1cf48c.js" as="script"><link rel="prefetch" href="/blog/assets/event-model.html-defc7bc9.js" as="script"><link rel="prefetch" href="/blog/assets/gc.html-563ee104.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d81f7618.js" as="script"><link rel="prefetch" href="/blog/assets/render.html-136cc72d.js" as="script"><link rel="prefetch" href="/blog/assets/router.html-dfa5452b.js" as="script"><link rel="prefetch" href="/blog/assets/topic-1-渲染流程.html-f94aa2d6.js" as="script"><link rel="prefetch" href="/blog/assets/topic-2-性能优化.html-ef097247.js" as="script"><link rel="prefetch" href="/blog/assets/bfc.html-9a576c35.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5412ce67.js" as="script"><link rel="prefetch" href="/blog/assets/prefix.html-5650758b.js" as="script"><link rel="prefetch" href="/blog/assets/responsive.html-1f054495.js" as="script"><link rel="prefetch" href="/blog/assets/babel.html-7dc82796.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0f6e2682.js" as="script"><link rel="prefetch" href="/blog/assets/other.html-b03be679.js" as="script"><link rel="prefetch" href="/blog/assets/vite_rollup.html-2e8368a9.js" as="script"><link rel="prefetch" href="/blog/assets/arrayBuffer.html-a7c42b8b.js" as="script"><link rel="prefetch" href="/blog/assets/async.html-60dcec3d.js" as="script"><link rel="prefetch" href="/blog/assets/class.html-8cc55fc9.js" as="script"><link rel="prefetch" href="/blog/assets/function.html-7834c5f1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-cee5492d.js" as="script"><link rel="prefetch" href="/blog/assets/iterator_generator.html-84be86fe.js" as="script"><link rel="prefetch" href="/blog/assets/let_const.html-74e24d31.js" as="script"><link rel="prefetch" href="/blog/assets/promise.html-b0522fd8.js" as="script"><link rel="prefetch" href="/blog/assets/set_map.html-c3e3749f.js" as="script"><link rel="prefetch" href="/blog/assets/widget.html-cb9477b9.js" as="script"><link rel="prefetch" href="/blog/assets/algorithm.html-466b7fef.js" as="script"><link rel="prefetch" href="/blog/assets/async-and-event_loop.html-b1397fb3.js" as="script"><link rel="prefetch" href="/blog/assets/data-type.html-0ecbc475.js" as="script"><link rel="prefetch" href="/blog/assets/fp.html-b85b24d3.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e52f4c51.js" as="script"><link rel="prefetch" href="/blog/assets/module.html-1810eae3.js" as="script"><link rel="prefetch" href="/blog/assets/prototype.html-464940f2.js" as="script"><link rel="prefetch" href="/blog/assets/scoped.html-37ff1969.js" as="script"><link rel="prefetch" href="/blog/assets/this.html-20a44493.js" as="script"><link rel="prefetch" href="/blog/assets/widget.html-f485dbb5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-10bfc81e.js" as="script"><link rel="prefetch" href="/blog/assets/micro-fe.html-63a8e384.js" as="script"><link rel="prefetch" href="/blog/assets/小程序.html-40407cf6.js" as="script"><link rel="prefetch" href="/blog/assets/fiber.html-a6899419.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-30415461.js" as="script"><link rel="prefetch" href="/blog/assets/core.html-3e0b49bd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-38b068fb.js" as="script"><link rel="prefetch" href="/blog/assets/between_2_and_3.html-ef613832.js" as="script"><link rel="prefetch" href="/blog/assets/computed_and_watch.html-7349a438.js" as="script"><link rel="prefetch" href="/blog/assets/core.html-66bd6281.js" as="script"><link rel="prefetch" href="/blog/assets/diff.html-2e35534a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-aa1733f1.js" as="script"><link rel="prefetch" href="/blog/assets/pinia _ vuex.html-08a94569.js" as="script"><link rel="prefetch" href="/blog/assets/pub-sub.html-9c42a081.js" as="script"><link rel="prefetch" href="/blog/assets/mediator.html-cafe0e50.js" as="script"><link rel="prefetch" href="/blog/assets/observer.html-0af728e7.js" as="script"><link rel="prefetch" href="/blog/assets/adapter.html-f5ecc03a.js" as="script"><link rel="prefetch" href="/blog/assets/brideg.html-bed2d6ab.js" as="script"><link rel="prefetch" href="/blog/assets/decorator.html-a55e2f06.js" as="script"><link rel="prefetch" href="/blog/assets/proxy.html-a00887c1.js" as="script"><link rel="prefetch" href="/blog/assets/factory.html-bbd1b412.js" as="script"><link rel="prefetch" href="/blog/assets/single.html-e799ea7a.js" as="script"><link rel="prefetch" href="/blog/assets/quick-sort.html-31061918.js" as="script"><link rel="prefetch" href="/blog/assets/sort.html-d865088d.js" as="script"><link rel="prefetch" href="/blog/assets/404.html-60b35caa.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3cf864cd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-adf52756.js" as="script"><link rel="prefetch" href="/blog/assets/wasm.html-b313f073.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3e730603.js" as="script"><link rel="prefetch" href="/blog/assets/gpt.html-d6e37fc7.js" as="script"><link rel="prefetch" href="/blog/assets/rust.html-0cec0fb4.js" as="script"><link rel="prefetch" href="/blog/assets/sso.html-612e1d89.js" as="script"><link rel="prefetch" href="/blog/assets/webrtc.html-ecb57a46.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-88465e0a.js" as="script"><link rel="prefetch" href="/blog/assets/http.html-4604b2a2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-460042da.js" as="script"><link rel="prefetch" href="/blog/assets/safe.html-5ec33b75.js" as="script"><link rel="prefetch" href="/blog/assets/binary-search.html-15da20df.js" as="script"><link rel="prefetch" href="/blog/assets/bit-operation.html-6747bb73.js" as="script"><link rel="prefetch" href="/blog/assets/catalog.html-a20b5187.js" as="script"><link rel="prefetch" href="/blog/assets/dp.html-270e12dd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-435af5d8.js" as="script"><link rel="prefetch" href="/blog/assets/other.html-aeaed0e6.js" as="script"><link rel="prefetch" href="/blog/assets/滑动窗口.html-66cdf5dc.js" as="script"><link rel="prefetch" href="/blog/assets/贪心和回溯.html-b195d988.js" as="script"><link rel="prefetch" href="/blog/assets/data-structure.html-72c36693.js" as="script"><link rel="prefetch" href="/blog/assets/cache.html-48ec8fa5.js" as="script"><link rel="prefetch" href="/blog/assets/cross.html-7484a115.js" as="script"><link rel="prefetch" href="/blog/assets/event-model.html-55be845b.js" as="script"><link rel="prefetch" href="/blog/assets/gc.html-4f5ca7c4.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-cfd329c1.js" as="script"><link rel="prefetch" href="/blog/assets/render.html-f28f56a5.js" as="script"><link rel="prefetch" href="/blog/assets/router.html-3c7d7a42.js" as="script"><link rel="prefetch" href="/blog/assets/topic-1-渲染流程.html-b775aec1.js" as="script"><link rel="prefetch" href="/blog/assets/topic-2-性能优化.html-9143eae7.js" as="script"><link rel="prefetch" href="/blog/assets/bfc.html-b07c9eb2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e6e3619a.js" as="script"><link rel="prefetch" href="/blog/assets/prefix.html-640ff714.js" as="script"><link rel="prefetch" href="/blog/assets/responsive.html-21ba4283.js" as="script"><link rel="prefetch" href="/blog/assets/babel.html-7735a7b2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9b6caee7.js" as="script"><link rel="prefetch" href="/blog/assets/other.html-5d94333e.js" as="script"><link rel="prefetch" href="/blog/assets/vite_rollup.html-12e37bdc.js" as="script"><link rel="prefetch" href="/blog/assets/arrayBuffer.html-13790678.js" as="script"><link rel="prefetch" href="/blog/assets/async.html-172ec57d.js" as="script"><link rel="prefetch" href="/blog/assets/class.html-1d2b4c53.js" as="script"><link rel="prefetch" href="/blog/assets/function.html-59ed56b8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-91ee64e0.js" as="script"><link rel="prefetch" href="/blog/assets/iterator_generator.html-515b7652.js" as="script"><link rel="prefetch" href="/blog/assets/let_const.html-4f0f2360.js" as="script"><link rel="prefetch" href="/blog/assets/promise.html-fd371f8c.js" as="script"><link rel="prefetch" href="/blog/assets/set_map.html-5f2555c7.js" as="script"><link rel="prefetch" href="/blog/assets/widget.html-fd738048.js" as="script"><link rel="prefetch" href="/blog/assets/algorithm.html-b3dba719.js" as="script"><link rel="prefetch" href="/blog/assets/async-and-event_loop.html-409fabab.js" as="script"><link rel="prefetch" href="/blog/assets/data-type.html-219c7376.js" as="script"><link rel="prefetch" href="/blog/assets/fp.html-189a2da9.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-8d2bfa5c.js" as="script"><link rel="prefetch" href="/blog/assets/module.html-7e5fd555.js" as="script"><link rel="prefetch" href="/blog/assets/prototype.html-93977f1c.js" as="script"><link rel="prefetch" href="/blog/assets/scoped.html-6c532f79.js" as="script"><link rel="prefetch" href="/blog/assets/this.html-40ed9b45.js" as="script"><link rel="prefetch" href="/blog/assets/widget.html-83633006.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-a892a658.js" as="script"><link rel="prefetch" href="/blog/assets/micro-fe.html-3c3c75dc.js" as="script"><link rel="prefetch" href="/blog/assets/小程序.html-d9f8648c.js" as="script"><link rel="prefetch" href="/blog/assets/fiber.html-2c746c26.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-bba4250b.js" as="script"><link rel="prefetch" href="/blog/assets/core.html-1d42920a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e699563b.js" as="script"><link rel="prefetch" href="/blog/assets/between_2_and_3.html-6b98fde3.js" as="script"><link rel="prefetch" href="/blog/assets/computed_and_watch.html-aa073587.js" as="script"><link rel="prefetch" href="/blog/assets/core.html-3c40c05c.js" as="script"><link rel="prefetch" href="/blog/assets/diff.html-bad8cc14.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b735e3ce.js" as="script"><link rel="prefetch" href="/blog/assets/pinia _ vuex.html-18be13b5.js" as="script"><link rel="prefetch" href="/blog/assets/pub-sub.html-5c16b751.js" as="script"><link rel="prefetch" href="/blog/assets/mediator.html-f298d990.js" as="script"><link rel="prefetch" href="/blog/assets/observer.html-047b1995.js" as="script"><link rel="prefetch" href="/blog/assets/adapter.html-b0168cd7.js" as="script"><link rel="prefetch" href="/blog/assets/brideg.html-062607c2.js" as="script"><link rel="prefetch" href="/blog/assets/decorator.html-b37d67e1.js" as="script"><link rel="prefetch" href="/blog/assets/proxy.html-a7ad8f50.js" as="script"><link rel="prefetch" href="/blog/assets/factory.html-4f305d0f.js" as="script"><link rel="prefetch" href="/blog/assets/single.html-95466993.js" as="script"><link rel="prefetch" href="/blog/assets/quick-sort.html-bcf9d249.js" as="script"><link rel="prefetch" href="/blog/assets/sort.html-acec4b67.js" as="script"><link rel="prefetch" href="/blog/assets/404.html-302c7c90.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/blog/" class=""><!----><!--v-if--></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/blog/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/front-end/" class="router-link-active" aria-label="front-end"><!--[--><!--]--> front-end <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/CS-other/" class="" aria-label="cs-other"><!--[--><!--]--> cs-other <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/algorithm-and-data" class="" aria-label="algorithm and data structure"><!--[--><!--]--> algorithm and data structure <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/blog/" class="" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/front-end/" class="router-link-active" aria-label="front-end"><!--[--><!--]--> front-end <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/CS-other/" class="" aria-label="cs-other"><!--[--><!--]--> cs-other <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/algorithm-and-data" class="" aria-label="algorithm and data structure"><!--[--><!--]--> algorithm and data structure <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading"> <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog/front-end/engineering/webpack.html#webpack" class="router-link-active router-link-exact-active sidebar-item" aria-label="webpack"><!--[--><!--]--> webpack <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog/front-end/engineering/webpack.html#构建流程" class="router-link-active router-link-exact-active sidebar-item" aria-label="构建流程"><!--[--><!--]--> 构建流程 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/front-end/engineering/webpack.html#compiler-compilation" class="router-link-active router-link-exact-active sidebar-item" aria-label="compiler compilation"><!--[--><!--]--> compiler compilation <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/front-end/engineering/webpack.html#loader-plugin" class="router-link-active router-link-exact-active sidebar-item" aria-label="loader/plugin"><!--[--><!--]--> loader/plugin <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/front-end/engineering/webpack.html#splitchunk" class="router-link-active router-link-exact-active sidebar-item" aria-label="splitChunk"><!--[--><!--]--> splitChunk <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/front-end/engineering/webpack.html#tree-shaking" class="router-link-active router-link-exact-active sidebar-item" aria-label="tree-shaking"><!--[--><!--]--> tree-shaking <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/front-end/engineering/webpack.html#hot-module-replace-hmr" class="router-link-active router-link-exact-active sidebar-item" aria-label="hot module replace HMR"><!--[--><!--]--> hot module replace HMR <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/blog/front-end/engineering/webpack.html#优化" class="router-link-active router-link-exact-active sidebar-item" aria-label="优化"><!--[--><!--]--> 优化 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/blog/front-end/engineering/webpack.html#针对webpack的优化" class="router-link-active router-link-exact-active sidebar-item" aria-label="针对webpack的优化"><!--[--><!--]--> 针对webpack的优化 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/blog/front-end/engineering/webpack.html#针对项目的优化-webpack" class="router-link-active router-link-exact-active sidebar-item" aria-label="针对项目的优化(webpack)"><!--[--><!--]--> 针对项目的优化(webpack) <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/blog/front-end/engineering/webpack.html#webpack-5" class="router-link-active router-link-exact-active sidebar-item" aria-label="webpack 5"><!--[--><!--]--> webpack 5 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h2 id="webpack" tabindex="-1"><a class="header-anchor" href="#webpack" aria-hidden="true">#</a> webpack</h2><p>是一种模块打包工具,可以将各类型的资源,如图片,css,js等, 转译组合为js格式的bunble文件</p><ol><li>构建流程</li><li>loader/ plugin</li><li>splitechunk</li><li>tree shaking</li><li>hmr</li></ol><h3 id="构建流程" tabindex="-1"><a class="header-anchor" href="#构建流程" aria-hidden="true">#</a> 构建流程</h3><ol><li>初始化阶段 <ol><li>初始化参数: 从配置文件、配置对象和 Shell 参数中读取并与默认参数进行合并，组合成最终使用的参数</li><li>创建编译对象：用上一步得到的参数创建 Compiler 对象</li><li>初始化编译环境：包括注入内置插件、注册各种模块工厂、初始化 RuleSet 集合、加载配置的插件等</li></ol></li><li>构建阶段 <ol><li>开始编译：执行 Compiler 对象的 run 方法，创建 Compilation 对象</li><li>确认编译入口: 根据 entry 找出所有入口文件 调用 compilition.addEntry 将入口文件转换为 dependence 对象</li><li>编译模块: 根据 entry 对应的 dependenve 创建 module 对象，调用 loader 将模块转译为标准的 js 内容， 调用 js 解释器 将内容 转换为 AST 对象， 冲中找出该模块依赖的模块， 再递归本步骤， 直至所有入口依赖文件都经过了本步骤处理</li><li>完成模块编译: 递归处理所有依赖能达到的模块后， 得到每个模块被编译后的内容 以及 它们之间的 依赖关系图</li></ol></li><li>生成阶段 <ol><li>输出资源: 根据入口和模块之间的依赖关系，组装成一个个包含多个模块的 Chunk，再把每个 Chunk 转换成一个单独的文件加入到输出列表，这步是可以修改输出内容的最后机会</li><li>写入文件系统: 确定好输出内容后，根据配置的 output 将内容写入文件系统</li></ol></li></ol><h3 id="compiler-compilation" tabindex="-1"><a class="header-anchor" href="#compiler-compilation" aria-hidden="true">#</a> compiler compilation</h3><ul><li>Compiler 对象包含了 Webpack 环境所有的的配置信息，包含 options，loaders，plugins 这些信息，这个对象在 Webpack 启动时候被实例化，它是全局唯一的，可以简单地把它理解为 Webpack 实例</li><li>Compilation 对象包含了当前的模块资源、编译生成资源、变化的文件等 只是代表了一次新的编译</li></ul><h3 id="loader-plugin" tabindex="-1"><a class="header-anchor" href="#loader-plugin" aria-hidden="true">#</a> loader/plugin</h3><p><em>loader</em> 转译文件,职责单一, 将源文件经过转化后输出, 输出内容为标准js文本 或 AST对象，并且可以链式调用 如 sass-loader -&gt; css -&gt; css-loader -&gt; 找出依赖资源 压缩css -&gt; style-loader -&gt; 转化成通过脚本加载的js</p><p><em>plugin</em> 插件， 用来增强 weback 功能， 解决 loader 无法实现的功能<br> webpack 本质是一个事件流机制，在运行的生命周期中会广播出许多事件， plugin 可以监听这些事件， 在合适的时机通过webpack提供的API改变输出结果 plugin 调用方式：异步 同步 异步并行串行 熔断方式(循环执行 跳过)</p><p>运行时机:</p><ul><li>loader: 打包文件前</li><li>plugin 全周期</li></ul><h3 id="splitchunk" tabindex="-1"><a class="header-anchor" href="#splitchunk" aria-hidden="true">#</a> splitChunk</h3><p>默认规则</p><ol><li>entry 分包处理</li><li>异步模块加载</li></ol><ul><li>require.ensure()</li><li>importy().then()</li></ul><h3 id="tree-shaking" tabindex="-1"><a class="header-anchor" href="#tree-shaking" aria-hidden="true">#</a> tree-shaking</h3><p>Tree-Shaking 是一种基于 ES Module 规范中 静态代码分析 的 无用代码删除 技术，它会在运行过程中静态分析模块之间的导入导出，确定 ESM 模块中哪些导出值未曾其它模块使用，并将其删除，以此实现打包产物的优化</p><p><em>webpack中具体实现</em> 先标记出模块导出值中哪些没有被用过， 使用 Terser 删除执行没有被用到的导出语句:</p><ul><li>编译阶段, 收集模块导出记录， 并记录到模块依赖关系图 ModuleGrapg 变量中</li><li>输出阶段， 遍历 ModuleGraph 标记模块导出变量有没有被使用</li><li>生成产物时， 变量没有被使用则删除对应的导出语句</li></ul><h3 id="hot-module-replace-hmr" tabindex="-1"><a class="header-anchor" href="#hot-module-replace-hmr" aria-hidden="true">#</a> hot module replace HMR</h3><p>本质是 webpack-dev-server, 添加了对webpack编译的监听， 并维护与浏览器间的websocket</p><ul><li>当编译文件变化时， 推送更新, 带上构建时的hash</li><li>比对hash,发起请求获取更改内容, 通过jsonp获取增量更新,使用内存文件系统去替换有修改的内容</li></ul><p>本质是开启了 express 应用， 添加了对webpack编译的监听, 添加了和浏览器的websocket长链接<br> 当文件变化 触发 webpack 进行编译并完成, 会通过 sokcet 消息告诉浏览器准备刷新 会刷新某个模块<br> webpack-dev-server 支持热更新 通过 生成文件的hash值来比对需要更新的模块，浏览器进行热替换</p><p>客户端监听到 hash 消息， 会执行 reloadApp 方法进行更新，在 reloadApp 中会判断是否支持热更新</p><ul><li>不支持直接 reload() 页面</li><li>支持 <ul><li>使用 jsonp 方式 获取最新代码</li><li>删除过期模块</li><li>将新的模块添加到 module 中</li><li>通过 _<em>webpack_require</em> 执行相关模块代码</li></ul></li></ul><h2 id="优化" tabindex="-1"><a class="header-anchor" href="#优化" aria-hidden="true">#</a> 优化</h2><ol><li>构建速度慢</li><li>业务复杂度增加 构建后模块多</li><li>多个项目间共用资源存在重复打包 基础库代码服用了不高</li><li>node 单进程</li></ol><h3 id="针对webpack的优化" tabindex="-1"><a class="header-anchor" href="#针对webpack的优化" aria-hidden="true">#</a> 针对webpack的优化</h3><p><em>提高打包速度</em></p><ol><li><p>优化 loader - 优化文件搜索范围 exclude 排除 node_module include 指定范围 - babel-loader 将编译过的文件缓存 cacheDirectory，</p></li><li><p>happyPack plugin - 将 loader 的同步执行转换为 并行</p></li><li><p>DllPlugin 将特定的类库提前打包然后引入， 主要用于类库打包 将公共代码抽离成单独文件</p></li><li><p>文件路径 - resolve.alias 映射别名 加快路径查找 - resolve.extensions 尽量减少后缀查找列表长度 - 避免层层查找</p></li><li><p>webpack-uglify-parallel 多核并行压缩</p></li></ol><h3 id="针对项目的优化-webpack" tabindex="-1"><a class="header-anchor" href="#针对项目的优化-webpack" aria-hidden="true">#</a> 针对项目的优化(webpack)</h3><p><em>减少打包体积</em></p><ol><li><p>代码压缩</p><ul><li>uglifyJS pro默认开启</li></ul></li><li><p>按需加载</p><ul><li>路由按需加载， 单独分包 chunk <ul><li>require.ensure</li><li>import()</li><li>runtime</li></ul></li></ul></li><li><p>scope hoisting 分析出模块间依赖， 将引用的模块进行提升， 多个相同引用仅打包成一份</p><ul><li>optimiztion.concatenateModule</li></ul></li><li><p>tree-shaking</p><ul><li>多使用 ESM 库， loadsh-es</li><li>webpack4 pro</li></ul></li><li><p>使用 url-loader svg-url-loader 进行图片压缩</p></li><li><p>externals commonChunksPlugin 分离提取三方库 排除不打包的依赖项， 进行cdn加速缓存</p></li><li><p>使用 ignore plugin 移除三方库中无用部分</p></li><li><p>gzip</p></li></ol><p><em>缓存</em></p><ol><li>split-chunks-plugins 大文件进行分包</li></ol><ul><li>将运行时代码进行单独打包， 不长修改的三方库进行缓存</li></ul><ol start="2"><li>文件名输出 使用 contenthash 区分版本 [name].[chunkname].js</li></ol><ul><li>[hash] 构建相关</li><li>[chunkhash] chunk 相关</li><li>[contenthash] 内容唯一 hash</li></ul><ol start="3"><li><p>提取三方库 运行时等 commonChunkPlugin</p><ul><li>使用 contenthash 进行长期缓存</li></ul></li><li></li></ol><ol><li>CommonsChunkPlugin 对多入口公有依赖进行提取</li></ol><h2 id="webpack-5" tabindex="-1"><a class="header-anchor" href="#webpack-5" aria-hidden="true">#</a> webpack 5</h2><ol><li>module Federation: 允许多个webpack 编译产物间共享模块和依赖</li></ol><ul><li>应用间组件互用</li><li>host 应用和 remote 应用组件的依赖共享</li></ul><ol start="2"><li>tree-shaking 优化</li></ol><ul><li>commonjs 通过对 <code>require()</code> 的调用跟踪一些相关的导出变量</li><li>export default 之前会被认为必使用， 现在会做更优的判断</li><li>嵌套的 tree-shaking， 跟踪对导出的嵌套属性的访问</li></ul><ol start="3"><li>持久化缓存</li></ol></div><!--[--><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/blog/assets/app-5e6e879c.js" defer></script>
  </body>
</html>
